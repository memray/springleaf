## library(readr)
setwd("~/Dropbox/DM/DataOnFeatureSelect")
## path <- "~/Dropbox/DM/DataOnFeatureSelect/"
## train.final <- read_csv(paste0(path, "train_final.csv", collapse = ""))

train.final <- readRDS("train_final.rds")
test.final <- readRDS("test_final.rds")

## read target variable
y <- read.csv("y.csv", header = T) 
y$target <- as.factor(y$target)

## select is the ranking index of variables based on information gain weights 

select <- c(55,56,1861,41,48,57,40,49,42,50,164,33,54,34,4,47,105,35,53,46,5,6,39,32,165,7,43,73,113,
            163,89,38,31,1028,52,45,104,1029,9,72,37,786,112,30,88,788,755,81,1230,1281,1015,1724,1723,
            1030,103,699,414,111,1845,71,1709,1710,11,1259,87,1275,12,783,13,1231,51,756,44,8,1232,1228,
            1024,1020,870,1025,80,591,102,36,1037,110,1026,70,86,931,592,932,159,1278,714,1716,28,1233,27,
            1229,29,1027,412,1223,787,1222,797,14,26,1721,936,79,924,1667,916,1708,935,1668,933,711,1252,
            1675,1691,937,1202,939,25,918,816,809,1669,1000,1016,819,940,1707,1728,1007,444,1729,1225,
            625,1274,24,1794,709,1798,1799,1005,820,1019,1036,1793,943,97,1694,1720,624,1004,1280,938,
            921,920,515,101,1180,517,514,1730,78,109,1040,872,1727,847,511,1722,1719,1676,508,616,948,
            512,1666,947,85,1264,974,822,1289,757,1001,761,69,821,612,796,1021,848,874,1219,1679,448,817,
            1158,871,697,749,1797,875,518,698,706,536,1227,1792,1731,1290,1257,696,1862,1791,513,501,823,
            1288,1790,626,1181,1778,483,1860,1292,1871,1008,1176,1035,1221,1022,941,1732,913,1680,818,
            1777,23,1874,704,620,1291,1177,1287,1218,1733,934,782,1011,862,1662,949,1725,794,516,945,726,
            1701,596,1283,929,987,908,1737,1261,946,1718,1262,1149,1702,1178,1272,589,1273,458,615,1683,
            500,800,1695,1734,909,861,863,96,1277,1780,1006,440,1703,844,1715,1763,1199,802,1240,743,1256,1781,
            843,595,454,923,1284,1711,1014,1670,1157,999,610,1684,1760,619,642,1023,134,1726,740,917,1220,930,
            1184,1051,1249,1773,1003,1491,1162,845,1736,598,599,1541,942,1198,954,130,1209,1217,1216,1052,1532,
            1537,1795,1042,597,1134,790,1405,1688,701,1772,1265,1276,1215,1783,759,1756,1175,827,1492,594,1542,
            1648,1161,1713,1705,1499,1789,1672,162,781,1197,490,491,443,1266,1697,1677,1867,989,1165,487,590,415,
            1740,1410,1185,1764,1706,1714,1322,1692,655,746,656,1870,747,857,1196,1129,1538,1500,1681,760,65,530
            ,1270,446,953,1472,770,488,1754,562,1466,1188,1255,988,1786,634,484,855,95,1704,1053,1712,1761,1493,
            1687,1321,1013,1239,1796,1154,629,990,1167,1543,1503,632,1238,1145,1608,1409,1673,1182,1671,1128,
            1150,1235,1234,1038,1660,695,742,1226,160,1467,1267,981,535,1504,1144,489,1260,1415,1371,858,975,
            1214,1465,21,1759,1501,609,1279,1661,497,798,741,842,1254,1174,447,1195,77,1411,1372,1685,1189,903,
            1426,1031,668,1207,1787,525,1054,1258,1717,1757,20,1505,902,758,132,611,1142,1699,1507,1325,763,
            1320,1152,1147,1508,1801,1550,509,1408,725,1420,1461,873,1753,1039,540,1106,1213,1307,1509,519,1148
            ,1419,1153,1055,1566,748,1471,1224,1269,492,1782,413,1784,776,1421,1473,623,652,1540,1545,1610,1136,
            1156,984,94,1758,1046,1802,784,1546,1738,926,1776,1544,1373,831,1308,153,1511,1690,1647,449,1271,1186
            ,1515,991,830,1533,1741,495,496,977,1050,1108,1237,1166,1513,1568,1464,950,1268,1125,1521,1285,654,
            1476,1779,1762,1529,1208,1496,1143,1584,735,1742,1138,128,1800,1686,1092,1552,1194,1309,1479,22,493,
            1246,928,1417,1132,849,1489,1689,3,1450,1502,520,510,1286,1599,745,1514,1598,993,1416,986,1376,1602,
            1516,499,801,1583,944,1582,1151,1146,1775,754,1512,1049,678,1506,64,1425,824,1251,1406,498,710,1774,
            1597,1190,1191,1551,1377,1581,1364,635,853,1696,593,1137,1170,707,1127,1698,1651,1374,1422,1596,1048,
            1498,1429,1110,1580,124,1788,1565,958,1203,1378,1163,1549,1650,1201,1093,462,1107,1785,1649,1187,
            1139,1169,486,712,762,1141,1253,1375,1536,1135,1564,1363,1210,835,1835,919,1567,1643,1449,485,
            1319,1682,751,702,780,1205,1183,979,460,1095,1306,1418,1382,1535,1448,1327,1311,1678,1765,1407,
            694,1412,1527,1519,63,1739,1365,1159,1644,420,1494,653,1096,1553,850,1381,1480,1085,461,1324,1547,
            1179,973,651,1700,126,1079,1600,1446,1326,807,1397,529,895,1522,982,983,1047,1520,1396,19,1539,
            1478,1528,554,1646,860,1080,1530,1431,1083,1609,1081,445,2,1250,1383,1495,1362,638,584,1380,1045,
            1497,1164,1370,851,1510,524,1475,994,859,1082,577,978,744,581,1639,1534,131,1302,628,1593,631,996,
            578,1645,1594,1200,995,1413,1531,1576,225,1312,646,1595,1577,1033,319,1323,805,633,962,539,1485,533,
            998,856,997,1313,1592,1578,1638,1518,1394,1523,1517,1525,1017,1097,563,970,1575,1211,1099,588,834,
            494,828,852,689,322,1611,1526,564,976,227,320,768,1002,1873,1573,560,1572,880,1314,1863,1589,332,
            1482,1588,527,1316,1755,1483,1866,1130,1084,980,538,1607,118,867,1571,1601,1447,125,1427,1379,
            1587,1872,1094,1554,765,1111,122,559,459,766,868,1562,1548,1430,1168,152,534,1586,1570,1318,528,
            1569,1120,1488,1591,1585,1481,791,1869,1390,841,1398,523,985,1674,959,971,1296,1212,93,866,927,
            662,339,1428,799,203,992,1487,333,717,206,532,1,1301,1160,1140,647,62,1590,565,572,1315,1486,1606,
            1561,1206,1604,141,1524,617,561,1555,587,1236,673,1112,331,1847,556,730,1123,166,1834,1642,271,1300,
            731,208,1122,1605,769,690,555,734,1018,963,684,865,1603,275,837,1098,1574,1385,832,1384,869,1317,
            1366,1563,457,1579,864,666,771,687,679,1395,1558,1559,1557,1556,1617,1560,1612,1297,439,537,1126,
            148,672,1012,676,774,773,1299,1133,1247,1172,884,1171,669,1303,789,366,1204,180,10,276,613,846,898,
            1294,972,531,966,521,641,1310,639,767,663,808,1086,793,1010,732,392,1173,1248,465,1386,1102,604,720,
            1392,1103,299,1470,1400,120,133,135,1009,899,1817,1809,1816,649,667,688,677,464,775,1118,1298,1101,
            603,522,621,724,1810,1665,1807,854,887,279,608,1641,814,228,1868,1423,910,557,1653,600,154,605,728,
            1808,601,244,552,705,278,1437,384,879,813,967,385,281,877,811,1656,1655,419,1440,1853,900,1293,1657,
            179,882,338,1403,1654,1104,348,198,602,1693,197,321,1387,1814,1652,881,1463,1815,878,680,1305,477,
            1393,1441,670,1819,1263,479,721,1388,1070,1659,476,1818,274,474,282,1812,1368,657,1432,283,452,
            1435,1282,1664,691,550,1401,1414,833,1663,1436,391,140,1829,1369,648,1658,876,1735,829,1402,1833,
            1304,1831,1804,964,1635,1640,1391,1399,1295,1636,1439,1121,682,1848,1827,185,1100,1811,1155,1626,
            1434,1806,812,777,1067,367,262,1105,1628,785,1830,1062,1131,1634,968,1355,1828,277,1073,210,1629,
            18,1624,1620,1359,1619,61,836,428,1404,1615,806,839,713,1616,1618,441,353,804,1627,708,1832,1193,
            1192,1625,1614,1072,815,703,925,1087,167,627,1032,475,1825,686,1813,1613,838,630,450,337,1637,114,
            482,1389,245,1424,792,1124,1109,1805,481,1367,1622,1623,1630,1633,1632,1631,1621,1091,480,675,752,
            1356,727,969,453,1826,1119,1071,840,1090,582,883,1438,960,1089,665,637,890,129,127,736,558,889,
            886,463,115,390,352,738,280,1077,139,17,1335,570,1334,700,1333,955,466,1442,1088,1344,548,549,
            1345,1074,418,273,658,1331,1332,1057,1433,779,907,1348,1346,739,1347,547,545,546,544,1339,543,
            1336,1340,1337,542,1343,541,1338,1341,1330,1342,1474,585,1329,901,1477,456,567,1358,1353,1076,
            583,436,1469,566,575,579,573,1350,170,1034,1445,438,1354,772,315,1349,451,336,1041,1462,1351,
            1352,1360,1060,213,116,571,176,1058,468,952,660,1043,1864,778,1444,569,123,951,121,425,188,1061,
            586,437,568,574,580,576,1078,904,1858,716,911,246,389,733,191,16,1766,233,906,502,1242,506,1803,
            377,692,718,505,1456,1243,503,810,217,1771,1770,1768,1767,1769,607,138,1849,681,100,750,671,108,
            151,661,1357,737,683,553,1361,478,150,1114,156,1117,1115,1116,1113,84,965,157,193,216,956,905,
            888,211,504,68,209,417,1056,335,1244,1245,1241,507,1443,1821,236,1850,1822,1823,1820,272,365,
            1459,961,551,424,1824,1044,471,399,398,292,381,382,376,764,219,181,1460,161,723,397,1876,423,
            659,235,192,442,234,231,383,435,957,1468,220,422,715,117,396,912,1059,215,388,394,1484,897,
            1490,643,1865,232,119,263,218,1746,1749,1744,1750,1743,1748,1747,1752,1745,1751,455,914,896,
            915,395,222,238,644,622,205,614,618,1852,891,241,237,693,606,239,1851,753,719,1857,393,334,
            380,15,214,224,204,1063,421,1458,467,223,221,387,1855,1065,247,243,1875,301,300,242,230,894,
            922,177,291,92,182,795,240,885,1457,1854,340,379,341,355,416,76,1066,183,664,472,359,1069,386,
            1075,347,137,373,368,284,893,261,674,354,1068,360,374,290,1064,722,285,186,83,323,349,362,60,
            324,99,470,107,307,253,892,91,67,286,685,473,318,650,212,350,363,1838,184,469,426,427,330,90,
            316,1455,803,346,1454,326,252,1856,1453,249,1452,229,298,289,825,378,1859,306,826,226,640,75,
            430,327,372,288,145,260,329,403,144,270,146,305,59,207,328,287,265,143,1843,308,1842,1844,361,1846,
            400,357,358,1840,1841,526,1839,401,369,364,74,66,58,370,1837,1451,1836,356,371,375,303,636,82,254,
            250,251,255,311,256,257,248,312,259,406,201,202,317,313,407,314,258,264,402,295,293,294,296,729,
            297,408,304,409,266,269,267,268,310,410,309,411,200,325,196,302,149,404,155,142,158,405,147,136,
            195,106,98,351,345,342,344,343,645,1328,168,429,431,187,189,169,190,194,432,178,433,175,434,171,172,
            173,174,199)

select.300 <- select[1:300]
select.600 <- select[1:600]
select.900 <- select[1:900]
select.1200 <- select[1:1200]
select.1500 <- select[1:1500]

train.final.300 <- train.final[, select.300]
test.final.300 <- subset(test.final, select = colnames(train.final.300))
train.final.300 <- cbind(train.final.300, y)

train.final.600 <- train.final[, select.600]
test.final.600 <- subset(test.final, select = colnames(train.final.600))
train.final.600 <- cbind(train.final.600, y)

train.final.900 <- train.final[, select.900]
test.final.900 <- subset(test.final, select = colnames(train.final.900))
train.final.900 <- cbind(train.final.900, y)

train.final.1200 <- train.final[, select.1200]
test.final.1200 <- subset(test.final, select = colnames(train.final.1200))
train.final.1200 <- cbind(train.final.1200, y)

train.final.1500 <- train.final[, select.1500]
test.final.1500 <- subset(test.final, select = colnames(train.final.1500))
train.final.1500 <- cbind(train.final.1500, y)

saveRDS(train.final.300, "train_ig_300.rds")
saveRDS(train.final.600, "train_ig_600.rds")
saveRDS(train.final.900, "train_ig_900.rds")
saveRDS(train.final.1200, "train_ig_1200.rds")
saveRDS(train.final.1500, "train_ig_1500.rds")

saveRDS(test.final.300, "test_ig_300.rds")
saveRDS(test.final.600, "test_ig_600.rds")
saveRDS(test.final.900, "test_ig_900.rds")
saveRDS(test.final.1200, "test_ig_1200.rds")
saveRDS(test.final.1500, "test_ig_1500.rds")